<!DOCTYPE HTML> 
<html lang="en-us"> 
<head> 
<meta charset="utf-8"> 
    <script src="https://cdn.firebase.com/v0/firebase.js"></script>0
<title>Options Screen</title> 
<script type="text/javascript"> 

// Your JavaScript function belongs here. 
/*function computeSize() {
	var adults = parseInt(document.getElementById("adults").value);
	var children = parseInt(document.getElementById("children").value);
	var infants = parseInt(document.getElementById("infants").value);
	var basic = parseInt(document.getElementById("basic").value);
	var deluxe = parseInt(document.getElementById("deluxe").value);
	var color = parseInt(document.getElementById("color").value);
	var familySize = adults + (children * 0.8) + (infants * 0.3) + deluxe + basic;

	document.getElementById("size").innerHTML = familySize;
}*/

</script> 
</head> 

<body> 
<h1>Options</h1>
<h2>Select number of persons to feed:</h2>

    <form id="optionsForm"> 
        <label>Adults</label>
		<select name="adults">
			<option value="0" selected="">       </option>
			<option value="1">1 Adult</option>
			<option value="2">2 Adults</option>
			<option value="3">3 Adults</option>
		</select><br>
		
        <label>Children</label>
        <select name="children">
			<option value="0" selected="">       </option>
			<option value="1">1 Child</option>
			<option value="2">2 Children</option>
			<option value="3">3 Children</option>
		</select><br>
		
        <label>Infants</label>
        <select name="infants">
			<option value="0" selected="">       </option>
			<option value="1">1 Infant</option>
			<option value="2">2 Infants</option>
			<option value="3">3 Infants</option>
		</select><br>

		<label>Months</label>
		<select name="months">
			<option value="0" selected="">       </option>
			<option value="1">1 Month</option>
			<option value="2">2 Months</option>
			<option value="3">3 Months</option>
			<option value="4">4 Months</option>
			<option value="5">5 Months</option>
			<option value="6">6 Months</option>
			<option value="9">9 Months</option>
			<option value="12">12 Months</option>
		</select><br><br>
		
			<input type="radio" name="group1" value="1" onclick="radioFunction(this.value)">Basic Storage<br>
			<input type="radio" name="group1" value="2" onclick="radioFunction(this.value)">Deluxe Storage<br>

	<h2>Edit food lists for allergies or preferences</h2>

		<label>Select a color scheme:</label>
		<select name="color">
			<option value="black">Black</option>
			<option value="white" selected="">White</option>
			<option value="green">Green</option>
			<option value="blue">Blue</option>
			<option value="red">Red</option>
			<option value="purple">Purple</option>
		</select><br><br>
    
        <a href="#" id="submitOptionsLink">Save Imputed Data</a>
    </form>
    <br><br>

    
    <h2>Fetch Form</h2>
	<form>
		<input id="lookupOptionsId" />
		<a href="#" id="getOptionsLink">Get from Firebase</a>
		<div id="output"></div>                     

		<h3>Family Size</h3><a href="#" id="lookupFamilySize">Lookup Family Size</a>
		<ul id="size"></ul>
	</form>
    
    <script>
var radioButton;
var radioFunction = function(bOrD){
	radioButton = bOrD;
	}
var lookupFamilySize = function(){
    event.preventDefault();
            
    var request = new XMLHttpRequest();
    request.open("GET", "https://foodforagingfiesta.firebaseio.com/options.json");
    request.send(null);
    request.onreadystatechange = function(){
        if (request.readyState == 4 && request.status == 200){    
			var userInputs = JSON.parse(request.responseText);
			console.log(userInputs);
			var outputList = document.getElementById('size');
            
			for (key in size){
				var liElement = document.createElement('li');
				liElement.textContent = size[key].name;
				outputList.appendChild(liElement);
			}
		}
    }
};
        
var postToFirebase = function(event){
    event.preventDefault();
	
    var family = {};
    family.adults = document.getElementById("optionsForm").adults.value;
	family.children = document.getElementById("optionsForm").children.value;
	family.infants = document.getElementById("optionsForm").infants.value;
	family.months = document.getElementById("optionsForm").months.value;
	family.basicOrDeluxe = radioButton;
	family.color = document.getElementById("optionsForm").color.value;
            
    var xhr = new XMLHttpRequest();
    xhr.open("POST", "https://foodforagingfiesta.firebaseio.com/options.json", true);
    xhr.setRequestHeader("Content-Type", "application/json");
           
    xhr.onreadystatechange = function() {
        console.log(xhr,xhr.readyState,xhr.status);
        if (xhr.readyState == 4 && xhr.status == 200) {
            var family = JSON.parse(xhr.responseText);
            console.log(family);
        }
    }
            
    xhr.send(JSON.stringify(family));
    console.log('ajax', xhr);
  
}
        
        
var putToFirebase = function(event) {
    event.preventDefault();
    var family = {};
    family.adults = document.getElementById("optionsForm").adults.value;
	family.children = document.getElementById("optionsForm").children.value;
	family.infants = document.getElementById("optionsForm").infants.value;
	family.months = document.getElementById("optionsForm").months.value;
	family.bOrD = radioButton;
	family.color = document.getElementById("optionsForm").color.value;
      
    var xhr = new XMLHttpRequest();
    xhr.open("PUT", "https://foodforagingfiesta.firebaseio.com/options.json", true);
    xhr.setRequestHeader("Content-Type", "application/json");
    xhr.send(JSON.stringify(family));
}
        
var getFromFirebase = function(event) {
	event.preventDefault();
    
	var id = document.getElementById("lookupOptionsId").value;
            
    var request = new XMLHttpRequest();
    request.open("GET", "https://foodforagingfiesta.firebaseio.com/options.json"+id+".json");
    request.send(null);
    request.onreadystatechange = function() {
        if (request.readyState == 4 && request.status == 200) {
            console.log(request.responseText)
            var family = JSON.parse(request.responseText);
            var output = document.getElementById("output");
            output.textContent = family;
        }
    }
};
             
              
var deleteFromFirebase = function(event) {
	event.preventDefault();
	var request = new XMLHttpRequest();
    request.open("DELETE", "https://foodforagingfiesta.firebaseio.com/options.json");
    request.send(null);
    request.onreadystatechange = function() {
        if (request.readyState == 4 && request.status == 204) {
            var output = document.getElementById("output");
            output.textContent = "";
        }
    }
};

var init = function() {
    document.getElementById('lookupOptionsId').addEventListener('click', lookupFamilySize);
	document.getElementById('submitOptionsLink').addEventListener('click', postToFirebase);
    document.getElementById('getOptionsLink').addEventListener('click', getFromFirebase);
           
};

document.addEventListener("DOMContentLoaded", init);
	</script>
    
<h2>Resource Links:</h2>
    <ul id="resource-links">
        <li><a href="https://www.lds.org/topics/food-storage">LDS Provident Living</a></li>
        <li><a href="http://www.thrivelife.com">Thrive</a></li>
        <li><a href="http://beprepared.com">Emergency Essentials</a></li>
    </ul>
</body> 
</html>
