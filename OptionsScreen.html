<!DOCTYPE HTML> 
<html lang="en-us"> 
<head> 
<meta charset="utf-8"> 
    <script src="https://cdn.firebase.com/v0/firebase.js"></script>0
<title>Options Screen</title> 
<script type="text/javascript"> 

// Your JavaScript function belongs here. 
/*function computeSize() {
	var adults = parseInt(document.getElementById("adults").value);
	var children = parseInt(document.getElementById("children").value);
	var infants = parseInt(document.getElementById("infants").value);
	var basic = parseInt(document.getElementById("basic").value);
	var deluxe = parseInt(document.getElementById("deluxe").value);
	var color = parseInt(document.getElementById("color").value);
	var familySize = adults + (children * 0.8) + (infants * 0.3) + deluxe + basic;

	document.getElementById("size").innerHTML = familySize;
}*/

</script> 
</head> 

<body> 
<h1>Options</h1>
<h2>Select number of persons to feed:</h2>

    <form id="optionsForm"> 
        <label># Adults:<input type="text" id="adults"></label><br> 
        <label># Children:<input type="text" id="children"></label><br>
        <label># Infants:<input type="text" id="infants"></label><br>

        <label># Months of Storage: <input type="text" id="months"></label><br><br>

        <label>Basic Storage <input type="text" id="basic"></label><br>
	   <label>Deluxe Storage <input type="text" id="deluxe"></label><br>

	<h2>Edit food lists for allergies or preferences</h2>

        <label>Select color scheme: <input type="text" id="color"></label>
    
        <a href="#" id="submitOptionsLink">Save</a>
    </form>
    <br><br>

    
    <h2>Fetch Form</h2>
    <input id="LookupOptionsId" />
         <a href="#" id="getOptionsLink">Get from Firebase</a>
    <div id="output"></div>                     

    <h3>Family Size</h3><a href="#" id="lookupFamilySize">Lookup Family Size</a>
    <ul id="size"></ul>
    
    <script>
        var lookupFamilySize =function(){
            event.preventDefault();
            
            var request = new XMLHttpRequest();
            request.open("GET", "https://foodforagingfiesta.firebaseio.com/options.json");
            request.send(null);
            request.onreadystatechange = function(){
                if (request.readyState == 4 && request.status == 200){    
        var adults = JSON.parse(request.responseText);
                console.log(adults);
       
            /* var children = JSON.parse(request.responseText);
                console.log(children);
        var infants = JSON.parse(request.responseText);
                console.log(infants);
        var months = JSON.parse(request.responseText);
                console.log(months);
                */
            
                var outputAdults = document.getElementById('adults');
                }
            }
        };
        
        var postToFirebase = function(event){
            event.preventDefault();
            var family = {};
            family.adults = document.getElementById("optionsForm").adults.value;
            
            var xhr = new XMLHttpRequest();
            xhr.open("POST", "https://foodforagingfiesta.firebaseio.com/options.json", true);
            xhr.setRequestHeader("Content-Type", "application/json");
            
             xhr.onreadystatechange = function() {
                console.log(xhr,xhr.readyState,xhr.status);
                if (xhr.readyState == 4 && xhr.status == 200) {
                    var optionsEntry = JSON.parse(xhr.responseText);
                    console.log(optionsEntry);
                    document.getElementById("lookupId").value = optionsEntry.adults;
                }
            }
            
             xhr.send(JSON.stringify(adults));
            console.log('ajax', xhr);
            
        }
        
        
        var putToFirebase = function(event) {
            event.preventDefault();
            var family = {};
            family.adults = document.getElementById("optionsForm").adults.value;
        
            var xhr = new XMLHttpRequest();
            xhr.open("PUT", "https://foodforagingfiesta.firebaseio.com/options.json", true);
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.send(JSON.stringify(adults));
        }
        
        var getFromFirebase = function(event) {
            event.preventDefault();
            
             var id = document.getElementById("lookupId").value;
            
            var request = new XMLHttpRequest();
            request.open("GET", "https://foodforagingfiesta.firebaseio.com/options.json"+id+".json");
            request.send(null);
            request.onreadystatechange = function() {
                if (request.readyState == 4 && request.status == 200) {
                    console.log(request.responseText)
                    var family = JSON.parse(request.responseText);
                    var output = document.getElementById("output");
                    output.textContent = family.adults;
                }
            }
        }
             
              
                    var deleteFromFirebase = function(event) {
            event.preventDefault();
            var request = new XMLHttpRequest();
            request.open("DELETE", "https://foodforagingfiesta.firebaseio.com/options.json");
            request.send(null);
            request.onreadystatechange = function() {
                if (request.readyState == 4 && request.status == 204) {
                    var output = document.getElementById("output");
                    output.textContent = "";
                }
            }
        }

        var init = function() {
            document.getElementById('lookupRecommendation').addEventListener('click', lookupFoodItems);
            document.getElementById('submitLink').addEventListener('click', postToFirebase);
            document.getElementById('getLink').addEventListener('click', getFromFirebase);
            
        };
        document.addEventListener("DOMContentLoaded", init);
    </script>
    
<h2>Resource Links:</h2>
    <ul id="resource-links">
        <li><a href="https://www.lds.org/topics/food-storage">LDS Provident Living</a></li>
        <li><a href="http://www.thrivelife.com">Thrive</a></li>
        <li><a href="http://beprepared.com">Emergency Essentials</a></li>
    </ul>
</body> 
</html>